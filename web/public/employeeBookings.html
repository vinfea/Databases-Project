<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Bookings</title>
</head>
<body>
    <h1>Employee Bookings</h1>
    <div id="bookingsContainer">
        <!-- Bookings will be displayed here -->
    </div>

    <script>
        // Function to make AJAX request to retrieve bookings
        function fetchBookings(username) {
            const apiUrl = '/api/getEmployeeBookings'; // Backend API endpoint URL

            // Fetch bookings for the logged-in employee
            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    // Assuming the backend requires basic authentication
                    'Authorization': 'Basic ' + btoa(username + ':' + password)
                },
                body: JSON.stringify({ username: username })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                displayBookings(data); // Display bookings on success
            })
            .catch(error => {
                console.error('Error fetching bookings:', error);
                const bookingsContainer = document.getElementById('bookingsContainer');
                bookingsContainer.innerHTML = '<p>Error fetching bookings. Please try again later.</p>';
            });
        }

        // Function to display bookings in HTML
        function displayBookings(bookings) {
            const bookingsContainer = document.getElementById('bookingsContainer');
            if (bookings && bookings.length > 0) {
                const bookingsHTML = bookings.map(booking => `
                    <div>
                        <p><strong>Booking ID:</strong> ${booking.booking_id}</p>
                        <p><strong>Room Number:</strong> ${booking.room_num}</p>
                        <p><strong>Hotel ID:</strong> ${booking.hotel_id}</p>
                        <p><strong>Chain:</strong> ${booking.chain}</p>
                        <p><strong>Customer SSN:</strong> ${booking.customer_SSN}</p>
                        <p><strong>Is Renting:</strong> ${booking.is_renting}</p>
                        <p><strong>Date:</strong> ${booking.date}</p>
                    </div>
                    <hr>
                `).join('');
                bookingsContainer.innerHTML = bookingsHTML;
            } else {
                bookingsContainer.innerHTML = '<p>No bookings found for this employee.</p>';
            }
        }

        // Username and password of the logged-in employee
        const username = 'bbrown';
        const password = 'defaultpassword';

        // Fetch bookings for the logged-in employee
        fetchBookings(username);
    </script>
</body>
</html>

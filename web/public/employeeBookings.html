<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Employee Bookings</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Employee Bookings</h1>
    <div id="bookingsContainer">
        <!-- Bookings will be displayed here -->
    </div>

    <script>
        function fetchBookings(username) {
            const apiUrl = '/api/getEmployeeBookings';
            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ username: username })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch bookings. Please try again later.');
                }
                return response.json();
            })
            .then(data => {
                displayBookings(data);
            })
            .catch(error => {
                console.error('Error fetching bookings:', error.message);
                const bookingsContainer = document.getElementById('bookingsContainer');
                bookingsContainer.innerHTML = `<p>${error.message}</p>`;
            });
        }

        function displayBookings(bookings) {
            const bookingsContainer = document.getElementById('bookingsContainer');
            if (bookings && bookings.length > 0) {
                let html = '<table>';
                html += '<tr><th>Booking ID</th><th>Room Number</th><th>Hotel ID</th><th>Chain</th><th>Customer SSN</th><th>Is Renting</th><th>Date</th></tr>';
                bookings.forEach(booking => {
                    html += `<tr>
                                <td>${booking.booking_id}</td>
                                <td>${booking.room_num}</td>
                                <td>${booking.hotel_id}</td>
                                <td>${booking.chain}</td>
                                <td>${booking.customer_SSN}</td>
                                <td>${booking.is_renting}</td>
                                <td>${booking.date}</td>
                            </tr>`;
                });
                html += '</table>';
                bookingsContainer.innerHTML = html;
            } else {
                bookingsContainer.innerHTML = '<p>No bookings found for this employee.</p>';
            }
        }

        const storedUsername = localStorage.getItem('username');
        if (storedUsername) {
            fetchBookings(storedUsername);
        } else {
            const bookingsContainer = document.getElementById('bookingsContainer');
            bookingsContainer.innerHTML = '<p>Username not found in localStorage.</p>';
        }
    </script>
</body>
</html>
